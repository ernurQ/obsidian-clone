(()=>{"use strict";const t=document.querySelector(".modal"),e=t.querySelector(".modal__content");function n(){t.classList.remove("modal_active"),e.innerHTML='\n        <div class="modal__close-btn">&times;</div>\n    '}t.addEventListener("click",(t=>{const e=t.target;null!=e&&(e.classList.contains("modal")||e.classList.contains("modal__close-btn"))&&n()}));class o{constructor(t,e,n){this.content=e,this.path=n,this.title=t}get id(){return this.title}_renderNotesPanel(){const t=document.createElement("li");t.classList.add("notes-panel__note"),t.textContent=this.title,document.querySelector(".notes-panel__list").append(t)}_renderNoteTab(){const t=document.createElement("li");t.classList.add("tab"),t.innerHTML=`\n            <div class="tab__content">${this.title}</div>\n            <div class="tab__close-btn">&times;</div>\n        `,document.querySelector(".tabs-list").append(t)}_renderNoteContent(){const t=document.createElement("input");t.classList.add("note__header"),t.type="text",t.value=this.title;const e=document.createElement("textarea");e.classList.add("note__content"),e.value=this.content;const n=document.createElement("li");n.classList.add("note"),n.append(t),n.append(e),document.querySelector(".workspace__notes").append(n)}render(){this._renderNotesPanel(),this._renderNoteTab(),this._renderNoteContent()}open(){this._renderNoteTab(),this._renderNoteContent()}getJson(){return{title:this.title,content:this.content,path:this.path}}}const s=document.querySelector(".workspace__notes");function a(t){s.querySelectorAll(".note").forEach((e=>{e.querySelector(".note__header").value!==t?e.classList.remove("note_active"):e.classList.add("note_active")}))}const c=document.querySelector(".tabs-list");function l(t){c.querySelectorAll(".tab").forEach((e=>{e.querySelector(".tab__content").textContent!==t?e.classList.remove("tab_active"):e.classList.add("tab_active")})),a(t)}function r(s){const c=document.createElement("form");c.innerHTML='\n        <form action="#" class="modal__form">\n        <label class="modal__label">\n            Note title\n            <input class="modal__input" name="title">\n        </label>\n        <label class="modal__label">\n            Note path\n            <input class="modal__input" placeholder="/" name="path">\n        </label>\n\n        <button class="modal__submit">create</button>\n        </form>\n    ',s.addEventListener("click",(()=>{var n;n=c,t.classList.add("modal_active"),e.append(n)})),c.addEventListener("submit",(t=>{t.preventDefault();let{title:e,path:s}=Object.fromEntries(new FormData(c).entries());if(""===s&&(s="/"),""===e)return;if(function(t){const e=i.querySelectorAll(".notes-panel__note");for(const n of e)if(n.textContent===t)return!0;return!1}(e))return;c.reset(),n();const r=new o(e,"",s);r.render(),l(e),a(e),function(t){const e="http://localhost:3000/notes";(async function(t,e){return fetch(t,{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(e)})})(e,t).then((t=>{if(!t.ok)throw new Error(`Could not post ${e}, status: ${t.status}`)}))}(r.getJson())}))}const i=document.querySelector(".notes-panel");document.addEventListener("DOMContentLoaded",(()=>{!function(){const t=document.querySelector(".navbar__notes-panel-btn"),e=document.querySelector(".notes-panel");t.addEventListener("click",(()=>{e.classList.toggle("notes-panel_collapsed")}))}(),r(i.querySelector(".notes-panel__new-note")),i.querySelector(".notes-panel__list").addEventListener("click",(t=>{const e=t.target;if(null!==e&&e.classList.contains("notes-panel__note")){const t=e.textContent;if(function(t){const e=c.querySelectorAll(".tab");for(const n of e)if(n.querySelector(".tab__content").textContent===t)return!0;return!1}(t))return l(t),void a(t);new o(t,"","/").open(),l(t),a(t)}})),c.addEventListener("click",(t=>{const e=t.target;if(null!==e){if(e.classList.contains("tab__close-btn")){const t=e,n=e.parentElement;return n.classList.add("tab_collapsed"),t.remove(),function(t){const e=s.querySelectorAll(".note");for(let n=0;n<e.length;n++){const o=e[n];if(o.querySelector(".note__header").value===t&&(o.remove(),o.classList.contains("note_active")&&e.length>1)){const t=e[0===n?1:0].querySelector(".note__header").value;console.log(t),l(t),a(t)}}}(n.querySelector(".tab__content").textContent),void setTimeout((()=>{n.remove()}),250)}if(e.classList.contains("tab__content")){if(e.parentElement.classList.contains("tab_active"))return;l(e.textContent)}if(e.classList.contains("tab")){if(e.classList.contains("tab_active"))return;l(e.querySelector(".tab__content").textContent)}}}))}))})();